(()=>{var e={767:e=>{e.exports=function(e){let t=e.url;if(void 0===t)return t;let s=e._parsedUrl;if(s&&s._raw===t)return s;s={},s.query=s.search=null,s.href=s.path=s.pathname=t;let r=t.indexOf("?",1);return-1!==r&&(s.search=t.substring(r),s.query=s.search.substring(1),s.pathname=t.substring(0,r)),s._raw=t,e._parsedUrl=s}},266:(e,t,s)=>{const r=s(685),n=s(160),{parse:i}=s(477),o=s(767);function a(e){return 47===e.charCodeAt(0)?e:"/"+e}function h(e){let t=e.indexOf("/",1);return t>1?e.substring(0,t):e}function d(e,t){t.url=t.url.substring(e.length)||"/",t.path=t.path.substring(e.length)||"/"}function c(e,t,s,n){let i=s.statusCode=e.code||e.status||500;s.end(e.length&&e||e.message||r.STATUS_CODES[i])}class l extends n{constructor(e={}){super(e),this.apps={},this.wares=[],this.bwares={},this.parse=o,this.server=e.server,this.handler=this.handler.bind(this),this.onError=e.onError||c,this.onNoMatch=e.onNoMatch||this.onError.bind(null,{code:404})}add(e,t,...s){let r=a(h(t));if(void 0!==this.apps[r])throw new Error(`Cannot mount ".${e.toLowerCase()}('${a(t)}')" because a Polka application at ".use('${r}')" already exists! You should move this handler into your Polka application instead.`);return super.add(e,t,...s)}use(e,...t){return"function"==typeof e?this.wares=this.wares.concat(e,t):"/"===e?this.wares=this.wares.concat(t):(e=a(e),t.forEach((t=>{if(t instanceof l)this.apps[e]=t;else{let s=this.bwares[e]||[];s.length>0||s.push(((t,s,r)=>(d(e,t),r()))),this.bwares[e]=s.concat(t)}}))),this}listen(){return(this.server=this.server||r.createServer()).on("request",this.handler),this.server.listen.apply(this.server,arguments),this}handler(e,t,s){s=s||this.parse(e);let r=[],n=this.wares,o=this.find(e.method,s.pathname);e.originalUrl=e.originalUrl||e.url;let a=h(e.path=s.pathname);void 0!==this.bwares[a]&&(n=n.concat(this.bwares[a])),o?(r=o.handlers,e.params=o.params):void 0!==this.apps[a]?(d(a,e),s.pathname=e.path,r.push(this.apps[a].handler.bind(null,e,t,s))):0===r.length&&r.push(this.onNoMatch),e.search=s.search,e.query=i(s.query);let c=0,l=n.length,u=r.length;if(l===c&&1===u)return r[0](e,t);let p=s=>s?this.onError(s,e,t,p):v(),v=s=>t.finished||c<l&&n[c++](e,t,p);n=n.concat(r),l+=u,v()}}e.exports=e=>new l(e)},160:(e,t,s)=>{const{exec:r,match:n,parse:i}=s(174);e.exports=class{constructor(e){this.opts=e||{},this.routes={},this.handlers={},this.all=this.add.bind(this,"*"),this.get=this.add.bind(this,"GET"),this.head=this.add.bind(this,"HEAD"),this.patch=this.add.bind(this,"PATCH"),this.options=this.add.bind(this,"OPTIONS"),this.connect=this.add.bind(this,"CONNECT"),this.delete=this.add.bind(this,"DELETE"),this.trace=this.add.bind(this,"TRACE"),this.post=this.add.bind(this,"POST"),this.put=this.add.bind(this,"PUT")}add(e,t,...s){return void 0===this.routes[e]&&(this.routes[e]=[]),this.routes[e].push(i(t)),void 0===this.handlers[e]&&(this.handlers[e]={}),this.handlers[e][t]=s,this}find(e,t){let s=n(t,this.routes[e]||[]);return!(0===s.length&&(s=n(t,this.routes[e="*"]||[]),!s.length))&&{params:r(t,s),handlers:this.handlers[e][s[0].old]}}}},441:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SidebarProvider=void 0;const r=s(496),n=s(686),i=s(601),o=s(714),a=s(326);t.SidebarProvider=class{constructor(e){this._extensionUri=e}resolveWebviewView(e){this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[this._extensionUri]},e.webview.html=this._getHtmlForWebview(e.webview),e.webview.onDidReceiveMessage((async t=>{switch(t.type){case"logout":o.TokenManager.setToken("");break;case"authenticate":(0,a.authenticate)((()=>{e.webview.postMessage({type:"token",value:o.TokenManager.getToken()})}));break;case"get-token":e.webview.postMessage({type:"token",value:o.TokenManager.getToken()});break;case"onInfo":if(!t.value)return;r.window.showInformationMessage(t.value);break;case"onError":if(!t.value)return;r.window.showErrorMessage(t.value)}}))}revive(e){this._view=e}_getHtmlForWebview(e){const t=e.asWebviewUri(r.Uri.joinPath(this._extensionUri,"media","reset.css")),s=e.asWebviewUri(r.Uri.joinPath(this._extensionUri,"media","vscode.css")),o=e.asWebviewUri(r.Uri.joinPath(this._extensionUri,"out","compiled/sidebar.js")),a=e.asWebviewUri(r.Uri.joinPath(this._extensionUri,"out","compiled/sidebar.css")),h=(0,n.getNonce)();return`<!DOCTYPE html>\n\t\t\t<html lang="en">\n\t\t\t<head>\n\t\t\t\t<meta charset="UTF-8">\n\t\t\t\t\x3c!--\n\t\t\t\t\tUse a content security policy to only allow loading images from https or from our extension directory,\n\t\t\t\t\tand only allow scripts that have a specific nonce.\n                 --\x3e\n                <meta http-equiv="Content-Security-Policy" content="img-src https: data:; style-src 'unsafe-inline' ${e.cspSource}; script-src 'nonce-${h}';">\n\t\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t\t\t\t<link href="${t}" rel="stylesheet">\n\t\t\t\t<link href="${s}" rel="stylesheet">\n                <link href="${a}" rel="stylesheet">\n                <script nonce=${h}>\n                    const tsvscode = acquireVsCodeApi();\n\t\t\t\t\tconst apiBaseUrl = ${JSON.stringify(i.apiBaseUrl)}\n                <\/script>\n\t\t\t</head>\n            <body>\n\t\t\t\t<script nonce="${h}" src="${o}"><\/script>\n\t\t\t</body>\n\t\t</html>`}}},714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenManager=void 0;const s="todosheettoken";t.TokenManager=class{static setToken(e){return this.globalState.update(s,e)}static getToken(){return this.globalState.get(s)}}},326:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authenticate=void 0;const r=s(496),n=s(601),i=s(266),o=s(714);t.authenticate=e=>{const t=i();t.get("/auth/:token",(async(s,r)=>{const{token:n}=s.params;n?(await o.TokenManager.setToken(n),e(),r.end("<h1>Auth was successful, you can close this now</h1>"),t.server.close()):r.end("<h1>Something went wrong</h1>")})),t.listen(54321,(e=>{e?r.window.showErrorMessage(e.message):r.commands.executeCommand("vscode.open",r.Uri.parse(`${n.apiBaseUrl}/auth/github`))}))}},601:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apiBaseUrl=void 0,t.apiBaseUrl="http://localhost:3000"},686:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNonce=void 0,t.getNonce=function(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let s=0;s<32;s++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}},496:e=>{"use strict";e.exports=require("vscode")},685:e=>{"use strict";e.exports=require("http")},477:e=>{"use strict";e.exports=require("querystring")},174:(e,t,s)=>{"use strict";function r(e,t){for(var s=0,r=e.length;s<r;s++)if(!t(e[s],s,e))return!1;return!0}s.r(t),s.d(t,{exec:()=>m,match:()=>g,parse:()=>b});const n="/",i=0,o=1,a=2,h=3,d=47,c=58,l=42,u=63;function p(e){if(e===n)return e;e.charCodeAt(0)===d&&(e=e.substring(1));var t=e.length-1;return e.charCodeAt(t)===d?e.substring(0,t):e}function v(e){return(e=p(e))===n?[n]:e.split(n)}function w(e,t,s){return s=e[s],t.val===s&&t.type===i||(s===n?t.type>o:t.type!==i&&(s||"").endsWith(t.end))}function g(e,t){for(var s,n,i=0,o=v(e),d=o.length,c=w.bind(w,o);i<t.length;i++)if(((n=(s=t[i]).length)===d||n<d&&s[n-1].type===a||n>d&&s[n-1].type===h)&&r(s,c))return s;return[]}function b(e){if(e===n)return[{old:e,type:i,val:e,end:""}];for(var t,s,r,v,w=p(e),g=-1,b=0,m=w.length,f=[];++g<m;)if((t=w.charCodeAt(g))!==c)if(t!==l){for(b=g;g<m&&w.charCodeAt(g)!==d;)++g;f.push({old:e,type:i,val:w.substring(b,g),end:""}),w=w.substring(g),m-=g,g=b=0}else f.push({old:e,type:a,val:w.substring(g),end:""});else{for(b=g+1,r=o,s=0,v="";g<m&&w.charCodeAt(g)!==d;)(t=w.charCodeAt(g))===u?(s=g,r=h):46===t&&0===v.length&&(v=w.substring(s=g)),g++;f.push({old:e,type:r,val:w.substring(b,s||g),end:v}),w=w.substring(g),m-=g,g=0}return f}function m(e,t){for(var s,r,i=0,o=v(e),a={};i<t.length;i++)s=o[i],r=t[i],s!==n&&void 0!==s&&r.type|2===h&&(a[r.val]=s.replace(r.end,""));return a}}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=s(496),n=s(441),i=s(714);e.activate=function(e){i.TokenManager.globalState=e.globalState;const s=new n.SidebarProvider(e.extensionUri),r=t.window.createStatusBarItem(t.StatusBarAlignment.Right);r.text="$(squirrel) Add Todo",r.command="todosheet.addTodo",r.show(),e.subscriptions.push(t.window.registerWebviewViewProvider("todosheet-sidebar",s)),e.subscriptions.push(t.commands.registerCommand("todosheet.addTodo",(()=>{const{activeTextEditor:e}=t.window;if(!e)return void t.window.showInformationMessage("No active text editor");const r=e.document.getText(e.selection);s._view?.webview.postMessage({type:"new-todo",value:r})}))),e.subscriptions.push(t.commands.registerCommand("todosheet.helloWorld",(()=>{t.window.showInformationMessage("token value: "+i.TokenManager.getToken())}))),e.subscriptions.push(t.commands.registerCommand("todosheet.refresh",(async()=>{await t.commands.executeCommand("workbench.action.closeSidebar"),await t.commands.executeCommand("workbench.view.extension.todosheet-sidebar-view"),setTimeout((()=>{t.commands.executeCommand("workbench.action.webview.openDeveloperTools")}),500)}))),e.subscriptions.push(t.commands.registerCommand("todosheet.askQuestion",(async()=>{const e=await t.window.showInformationMessage("How was your day?","Good","Bad");"Bad"===e?t.window.showInformationMessage("Sorry to hear that :("):console.log({answer:e})})))},e.deactivate=function(){}})(),module.exports=r})();